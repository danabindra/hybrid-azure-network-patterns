# ADR-0002: Use Traditional Hub-Spoke Architecture Over Azure vWAN

## Status
Accepted

## Context
We need to establish a scalable, secure network architecture for our Azure deployment that will:
- Support multi-region deployments with Central US (primary) and East US 2 (secondary)
- Integrate with on-premises networks via ExpressRoute and SD-WAN
- Provide centralized security inspection through Network Virtual Appliances (NVAs)
- Allow granular control over routing and security policies
- Support zero-trust network segmentation

Azure offers two primary patterns:
1. **Traditional Hub-Spoke**: Customer-managed topology with VNet peering
2. **Azure vWAN**: Microsoft-managed service with simplified routing

## Decision
We will implement a **Traditional Hub-Spoke architecture** with customer-managed components.

## Consequences

### Positive
- **Complete Control**: Full control over routing tables, security policies, and traffic flows
- **NVA Flexibility**: Can use Check Point CloudGuard or FortiGate VMSS with custom configurations
- **Proven Pattern**: Well-documented, widely adopted pattern with extensive community support
- **Cost Transparency**: Predictable costs without vWAN service charges
- **BGP Support**: Native eBGP peering with Azure Route Server for dynamic routing
- **Inspection Granularity**: All traffic can be forced through NVAs for deep packet inspection

### Negative
- **Management Overhead**: Requires manual configuration of peerings and route tables
- **Complexity**: More complex initial setup compared to vWAN automation
- **Scaling Effort**: Adding new spokes requires manual peering configuration
- **No Built-in Transit**: Must implement transit connectivity through NVAs

### Neutral
- **Skills Requirement**: Team needs expertise in Azure networking, but this aligns with our hiring plan
- **Automation Need**: Requires Infrastructure as Code (Terraform) for consistency

## Implementation Notes
- Use Terraform modules to standardize hub and spoke deployments
- Implement User-Defined Routes (UDRs) with 0.0.0.0/0 pointing to NVA
- Disable gateway route propagation on spokes to prevent bypassing NVAs
- Use Azure Policy to enforce network standards

## References
- [Azure Hub-Spoke Reference Architecture](https://docs.microsoft.com/azure/architecture/reference-architectures/hybrid-networking/hub-spoke)
- [Network Topology and Connectivity - Architecture Document](../architecture/network-topology.md)
- Original presentation requirement specifying need for granular control

## Decision Makers
- Network Architecture Team
- Security Team
- Cloud Platform Team

## Date
2024-01-15

## Review Date
2024-07-15 (6 months)