<svg viewBox="0 0 1200 700" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="1200" height="700" fill="#f8f9fa"/>
  
  <!-- Branch Office -->
  <g id="branch">
    <rect x="50" y="150" width="140" height="100" rx="8" fill="#e3f2fd" stroke="#1976d2" stroke-width="2"/>
    <text x="120" y="175" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">Branch Office</text>
    <text x="120" y="195" text-anchor="middle" font-family="Arial" font-size="12">Remote Site</text>
    <text x="120" y="210" text-anchor="middle" font-family="Arial" font-size="10">10.1.50.0/24</text>
    
    <!-- vEdge Router -->
    <rect x="90" y="220" width="60" height="20" rx="3" fill="#ff9800" stroke="#f57c00"/>
    <text x="120" y="232" text-anchor="middle" font-family="Arial" font-size="10" fill="white" font-weight="bold">vEdge Router</text>
  </g>
  
  <!-- MPLS Cloud -->
  <g id="mpls">
    <ellipse cx="350" cy="200" rx="100" ry="60" fill="#fff3e0" stroke="#f57c00" stroke-width="3"/>
    <text x="350" y="185" text-anchor="middle" font-family="Arial" font-size="16" font-weight="bold">MPLS Backbone</text>
    <text x="350" y="205" text-anchor="middle" font-family="Arial" font-size="12">AS 25676</text>
    <text x="350" y="220" text-anchor="middle" font-family="Arial" font-size="10">BGP/ISIS Core</text>
    
    <!-- PE Routers -->
    <circle cx="310" cy="240" r="8" fill="#f57c00"/>
    <text x="310" y="255" text-anchor="middle" font-family="Arial" font-size="8">PE-1</text>
    <circle cx="390" cy="240" r="8" fill="#f57c00"/>
    <text x="390" y="255" text-anchor="middle" font-family="Arial" font-size="8">PE-2</text>
  </g>
  
  <!-- ExpressRoute Circuit -->
  <g id="expressroute">
    <rect x="520" y="160" width="120" height="80" rx="8" fill="#e8f5e8" stroke="#4caf50" stroke-width="3"/>
    <text x="580" y="185" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">ExpressRoute</text>
    <text x="580" y="205" text-anchor="middle" font-family="Arial" font-size="12">Central Region</text>
    <text x="580" y="220" text-anchor="middle" font-family="Arial" font-size="10">1 Gbps Circuit</text>
    <text x="580" y="235" text-anchor="middle" font-family="Arial" font-size="9">Microsoft Peering</text>
  </g>
  
  <!-- Azure Hub VNet -->
  <g id="hub-vnet">
    <rect x="720" y="80" width="320" height="240" rx="10" fill="#e3f2fd" stroke="#2196f3" stroke-width="3"/>
    <text x="880" y="105" text-anchor="middle" font-family="Arial" font-size="16" font-weight="bold">Azure Hub VNet (Central)</text>
    <text x="880" y="125" text-anchor="middle" font-family="Arial" font-size="12">10.100.0.0/16</text>
    
    <!-- ExpressRoute Gateway -->
    <rect x="740" y="140" width="90" height="35" rx="5" fill="#fff3e0" stroke="#ff9800" stroke-width="2"/>
    <text x="785" y="158" text-anchor="middle" font-family="Arial" font-size="10" font-weight="bold">ER Gateway</text>
    <text x="785" y="170" text-anchor="middle" font-family="Arial" font-size="8">GatewaySubnet</text>
    
    <!-- FortiGate VMSS -->
    <rect x="850" y="140" width="110" height="45" rx="5" fill="#ffebee" stroke="#f44336" stroke-width="2"/>
    <text x="905" y="158" text-anchor="middle" font-family="Arial" font-size="11" font-weight="bold">FortiGate VMSS</text>
    <text x="905" y="172" text-anchor="middle" font-family="Arial" font-size="9">Security Cluster</text>
    <text x="905" y="182" text-anchor="middle" font-family="Arial" font-size="8">10.100.1.0/24</text>
    
    <!-- Internal Load Balancer -->
    <rect x="740" y="200" width="90" height="30" rx="5" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2"/>
    <text x="785" y="218" text-anchor="middle" font-family="Arial" font-size="10" font-weight="bold">Internal LB</text>
    <text x="785" y="228" text-anchor="middle" font-family="Arial" font-size="8">10.100.2.100</text>
    
    <!-- NAT Gateway -->
    <rect x="850" y="200" width="110" height="30" rx="5" fill="#fff8e1" stroke="#ffa000" stroke-width="2"/>
    <text x="905" y="218" text-anchor="middle" font-family="Arial" font-size="10" font-weight="bold">NAT Gateway</text>
    <text x="905" y="228" text-anchor="middle" font-family="Arial" font-size="8">Internet Egress</text>
    
    <!-- Public IP -->
    <rect x="740" y="250" width="90" height="30" rx="5" fill="#e8f5e8" stroke="#4caf50" stroke-width="2"/>
    <text x="785" y="268" text-anchor="middle" font-family="Arial" font-size="10" font-weight="bold">Public IP</text>
    <text x="785" y="278" text-anchor="middle" font-family="Arial" font-size="8">52.168.1.100</text>
    
    <!-- Route Table -->
    <rect x="850" y="250" width="110" height="30" rx="5" fill="#e1f5fe" stroke="#0288d1" stroke-width="2"/>
    <text x="905" y="268" text-anchor="middle" font-family="Arial" font-size="10" font-weight="bold">Route Table</text>
    <text x="905" y="278" text-anchor="middle" font-family="Arial" font-size="8">0.0.0.0/0 â†’ NAT GW</text>
  </g>
  
  <!-- Spoke VNet -->
  <g id="spoke-vnet">
    <rect x="720" y="380" width="320" height="120" rx="10" fill="#f3e5f5" stroke="#9c27b0" stroke-width="3"/>
    <text x="880" y="405" text-anchor="middle" font-family="Arial" font-size="16" font-weight="bold">Spoke VNet</text>
    <text x="880" y="425" text-anchor="middle" font-family="Arial" font-size="12">10.101.0.0/16</text>
    
    <!-- Application Subnet -->
    <rect x="740" y="440" width="140" height="50" rx="5" fill="#e8f5e8" stroke="#4caf50" stroke-width="2"/>
    <text x="810" y="460" text-anchor="middle" font-family="Arial" font-size="11" font-weight="bold">Application Subnet</text>
    <text x="810" y="475" text-anchor="middle" font-family="Arial" font-size="9">Web Servers</text>
    <text x="810" y="485" text-anchor="middle" font-family="Arial" font-size="8">10.101.1.0/24</text>
    
    <!-- Database Subnet -->
    <rect x="900" y="440" width="120" height="50" rx="5" fill="#fff3e0" stroke="#ff9800" stroke-width="2"/>
    <text x="960" y="460" text-anchor="middle" font-family="Arial" font-size="11" font-weight="bold">Database Subnet</text>
    <text x="960" y="475" text-anchor="middle" font-family="Arial" font-size="9">SQL Servers</text>
    <text x="960" y="485" text-anchor="middle" font-family="Arial" font-size="8">10.101.2.0/24</text>
  </g>
  
  <!-- Internet Cloud -->
  <g id="internet">
    <ellipse cx="880" cy="40" rx="80" ry="30" fill="#f1f8e9" stroke="#689f38" stroke-width="3"/>
    <text x="880" y="35" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">Internet</text>
    <text x="880" y="50" text-anchor="middle" font-family="Arial" font-size="10">0.0.0.0/0</text>
  </g>
  
  <!-- VNet Peering Connection -->
  <g id="peering">
    <path d="M 880 320 Q 880 340 880 380" stroke="#9c27b0" stroke-width="4" fill="none" stroke-dasharray="8,4"/>
    <text x="895" y="350" font-family="Arial" font-size="11" fill="#9c27b0" font-weight="bold">VNet Peering</text>
  </g>
  
  <!-- Traffic Flow Arrows -->
  <g id="arrows">
    <!-- MPLS to ER -->
    <path d="M 300 200 L 370 200" stroke="#ff5722" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
    
    <!-- ER to Hub Gateway -->
    <path d="M 490 190 L 590 160" stroke="#ff5722" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
    
    <!-- FortiGate to NAT Gateway -->
    <path d="M 755 185 L 755 200" stroke="#4caf50" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
    <text x="775" y="195" text-anchor="middle" font-family="Arial" font-size="9" fill="#4caf50" font-weight="bold">Inspect</text>
    
    <!-- NAT Gateway to Internet -->
    <path d="M 730 200 L 730 70" stroke="#4caf50" stroke-width="4" fill="none" marker-end="url(#arrowhead)"/>
    <text x="750" y="135" text-anchor="middle" font-family="Arial" font-size="11" fill="#4caf50" font-weight="bold">Internet Egress</text>
    
    <!-- Spoke to Hub -->
    <path d="M 730 380 L 730 320" stroke="#ff5722" stroke-width="3" fill="none" marker-end="url(#arrowhead)" stroke-dasharray="5,3"/>
    <text x="710" y="350" text-anchor="middle" font-family="Arial" font-size="9" fill="#ff5722">Web Traffic</text>
  </g>
  
  <!-- Arrow marker definition -->
  <defs>
    <marker id="arrowhead" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#ff5722"/>
    </marker>
  </defs>
  
  <!-- Internet Traffic Flow Configuration -->
  <g id="config-box">
    <rect x="50" y="400" width="600" height="260" rx="10" fill="#e3f2fd" stroke="#1976d2" stroke-width="2"/>
    <text x="350" y="425" text-anchor="middle" font-family="Arial" font-size="16" font-weight="bold">Internet Egress Configuration</text>
    
    <!-- FortiGate Policy -->
    <rect x="70" y="440" width="270" height="100" rx="5" fill="#fff" stroke="#666"/>
    <text x="205" y="460" text-anchor="middle" font-family="Arial" font-size="12" font-weight="bold">FortiGate Security Policy</text>
    <text x="80" y="480" font-family="Courier" font-size="9">policy-id 100</text>
    <text x="90" y="495" font-family="Courier" font-size="9">srcintf "internal"</text>
    <text x="90" y="510" font-family="Courier" font-size="9">dstintf "external"</text>
    <text x="90" y="525" font-family="Courier" font-size="9">action accept nat enable</text>
    
    <!-- NAT Configuration -->
    <rect x="360" y="440" width="270" height="100" rx="5" fill="#fff" stroke="#666"/>
    <text x="495" y="460" text-anchor="middle" font-family="Arial" font-size="12" font-weight="bold">NAT Gateway Configuration</text>
    <text x="370" y="480" font-family="Courier" font-size="9">Source NAT: 10.100.0.0/16</text>
    <text x="370" y="495" font-family="Courier" font-size="9">Public IP: 52.168.1.100</text>
    <text x="370" y="510" font-family="Courier" font-size="9">Outbound Rules: Allow All</text>
    <text x="370" y="525" font-family="Courier" font-size="9">Idle Timeout: 4 minutes</text>
    
    <!-- Route Table -->
    <rect x="70" y="560" width="270" height="80" rx="5" fill="#fff" stroke="#666"/>
    <text x="205" y="580" text-anchor="middle" font-family="Arial" font-size="12" font-weight="bold">Route Table Rules</text>
    <text x="80" y="600" font-family="Courier" font-size="9">0.0.0.0/0 â†’ NAT Gateway</text>
    <text x="80" y="615" font-family="Courier" font-size="9">10.101.0.0/16 â†’ FortiGate</text>
    <text x="80" y="630" font-family="Courier" font-size="9">10.1.0.0/8 â†’ ER Gateway</text>
    
    <!-- Traffic Flow -->
    <rect x="360" y="560" width="270" height="80" rx="5" fill="#fff" stroke="#666"/>
    <text x="495" y="580" text-anchor="middle" font-family="Arial" font-size="12" font-weight="bold">Traffic Flow Path</text>
    <text x="370" y="600" font-family="Arial" font-size="9">1. Spoke â†’ Hub via VNet Peering</text>
    <text x="370" y="615" font-family="Arial" font-size="9">2. Hub UDR â†’ FortiGate inspection</text>
    <text x="370" y="630" font-family="Arial" font-size="9">3. FortiGate â†’ NAT GW â†’ Internet</text>
  </g>
</svg>